var CompareNoReload={compareAnimationCount:0,compareRemoveFromListSilent:function(a){new Ajax.Request(a,{onSuccess:function(b){CompareNoReload.compareUpdateSidebarHtml(b.responseText);CompareNoReload.rescanForNewCompare()}})},compareClearList:function(a,b){new Ajax.Request(a,{onSuccess:function(c){CompareNoReload.compareUpdateSidebarHtml(c.responseText);CompareNoReload.rescanForNewCompare()}})},compareAddToList:function(a,b){this.startAnimation(b);new Ajax.Request(a,{onSuccess:function(c){CompareNoReload.compareUpdateSidebarHtml(c.responseText);CompareNoReload.rescanForNewCompare()}});return false},compareUpdateSidebarHtml:function(updateText){if(typeof(this.getCompareSideBlock())!="undefined"){this.getCompareSideBlock().replace(eval(updateText))}},startAnimation:function(c){if(typeof(c)!="undefined"){if((typeof(this.getCompareSideBlock())!="undefined")&($(c)!=null)){var j=this.getCompareSideBlock().cumulativeOffset();var b=this.getCompareSideBlock().getDimensions();var a={top:j[1]+b.height-5-22,left:j[0]+b.width-5-79,width:79,height:22};var g=10;var f=0.75;var j=$(c).cumulativeOffset();var b=$(c).getDimensions();var e={top:j[1],left:j[0],width:b.width,height:b.height};var k=(a.left-e.left)*2/g/g;var h=(a.top-e.top)*2/g/g;if($("animated_div")==null){$$("div.wrapper")[0].insert({bottom:'<div id="animated_div"></div>'})}$("animated_div").setStyle({position:"absolute",left:e.left+"px",top:e.top+"px",width:e.width+"px",height:e.height+"px",display:""});$("animated_div").setOpacity(0.7);for(var d=0;d<g;d++){Element.setStyle.delay(f/g*d,"animated_div",{top:(e.top+parseInt(h*d*d/2))+"px",left:(e.left+parseInt(k*d*d/2))+"px",width:(e.width-parseInt((e.width-a.width)/g*d))+"px",height:(e.height-parseInt((e.height-a.height)/g*d))+"px"})}Element.setStyle.delay(f/g*(g+1),"animated_div",{display:"none"})}}},compareAnimationMove:function(){new PeriodicalExecuter(function(a){this.compareAnimationCount++},0.2)},rescanForNewCompare:function(){var d=$$("a[href*=product_compare/add/product]");for(var b=0;b<d.length;b++){if(d[b].readAttribute("oldlink")==null){var a=d[b].href;d[b].href="#";d[b].writeAttribute("oldlink",a);var e=this.findParentByCss(d[b],"li.item");if(e==null){e=this.findParentByCss(d[b],"li")}if(e.id==""){e.id="divforcomparing"+b}var c=new String(a);rExp=/\/add\//gi;a=c.replace(rExp,"/silentadd/");d[b]["onclick"]=new Function("return CompareNoReload.compareAddToList('"+a+"','"+e.id+"')")}}var d=$$("a[href*=product_compare/clear]");for(var b=0;b<d.length;b++){if(d[b].readAttribute("oldlink")==null){var a=d[b].href;d[b].writeAttribute("oldlink",a);var c=new String(a);rExp=/\/clear\//gi;a=c.replace(rExp,"/silentclear/");d[b].href="javascript:CompareNoReload.compareClearList('"+a+"')"}}var d=$$("a[href*=product_compare/remove]");for(var b=0;b<d.length;b++){if(d[b].readAttribute("oldlink")==null){var a=d[b].href;d[b].writeAttribute("oldlink",a);var c=new String(a);rExp=/\/remove\//gi;a=c.replace(rExp,"/silentremove/");d[b].href="javascript:CompareNoReload.compareRemoveFromListSilent('"+a+"')"}}},findParentByCss:function(a,c){var b=a.parentNode;if(b.tagName=="body"){return null}if(b.tagName=="BODY"){return null}if($(b).match(c)){return b}else{return this.findParentByCss(a.parentNode,c)}},getCompareSideBlock:function(){if($$("div.mini-compare-products").length>0){return $$("div.mini-compare-products")[0]}return $$("div.block-compare")[0]}};Event.observe(window,"load",function(){CompareNoReload.rescanForNewCompare();if(CompareNoReload.getCompareSideBlock()==null){if($$("div.col-left").length>0){$$("div.col-left")[0].insert({bottom:'<div class="block-compare"></div>'})}else{if($$("div.col-right").length>0){$$("div.col-right")[0].insert({bottom:'<div class="block-compare"></div>'})}}}});