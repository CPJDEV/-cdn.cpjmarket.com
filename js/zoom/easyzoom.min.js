(function(b,c){function a(B,d){var o={id:"zoom-window",parent:"body",preload:"Loading...",lightboxBtn:false,error:"<p>There has been a problem attempting to loading the image.</p>"};this.options=b.extend({},o,d);var s=this,w=false,r=true,l,p,n,m,k,j,i,h,g,f,t,y=false;function x(){s.elements={$target:b(B),$source:b("img",B),$parent:b(s.options.parent),$panel:b('<div id="'+s.options.id+'">'+s.options.preload+"</div>").css("display","none")};q(s.elements.$target.attr("href"));s.elements.$target.on("click.easyZoom",function(C){C.preventDefault()}).on("mouseover.easyZoom",function(C){e(C)}).on("mouseout.easyZoom",function(){s.hide()}).on("mousemove.easyZoom",function(C){u(C)})}function q(C){w=false;s.elements.$zoomed=s.loadimg(C).on("error.easyZoom",function(){r=false}).on("load.easyZoom",function(){w=true;s.elements.$zoomed.off(".easyZoom")})}function e(C){s.elements.$panel.appendTo(s.elements.$parent);if(!r){v()}else{if(w){A(C)}else{z(C)}}}function z(C){if(w){A(C);clearTimeout(l)}else{s.elements.$target.css("cursor","progress");l=setTimeout(function(){z(C)},200)}}function v(){s.elements.$panel.html(s.options.error)}function u(G){if(y){var F=s.elements.$source.offset(),D=G.pageX-F.left,E=G.pageY-F.top,H=D*f,C=E*t;H=(H>k)?k:H;C=(C>g)?g:C;s.elements.$zoomed.css({left:-H,top:-C})}}function A(C){y=true;s.elements.$target.css("cursor","crosshair");s.elements.$panel.append(s.elements.$zoomed.css({position:"absolute"})).fadeIn(200);p=s.elements.$source.width();j=s.elements.$source.height();n=s.elements.$panel.width();i=s.elements.$panel.height();k=s.elements.$zoomed.width()-n;g=s.elements.$zoomed.height()-i;f=k/p;t=g/j;u(C)}this.loadimg=function(D){var C=new Image();C.src=D+"?"+(new Date()).getTime();C.onload=function(){C=null};return b(C)};this.hide=function(){if(y){y=false;s.elements.$target.css("cursor","default");s.elements.$panel.fadeOut(200,function(){s.elements.$panel=s.elements.$panel.remove().html("")})}};this.update=function(C){this.hide();q(C)};this.destroy=function(){this.hide()};if(B.tagName.toLowerCase()==="a"){x();return this}}b.fn.easyZoom=function(d){return this.each(function(){b.data(this,"easyZoom",new a(this,d))})};a.prototype.gallery=function(d,g){var f=this,e=g?b(g):this.elements.$parent;e.on("click",d,function(j){j.preventDefault();var i=b(this).addClass("thumbnail-loading"),k=i.attr("href"),h=i.data("easyzoom-source");f.loadimg(h).on("load",function(){f.elements.$source.attr("src",h);f.elements.$target.attr("href",k);if(f.options.lightboxBtn){jQuery(f.options.lightboxBtn).attr("href",k)}f.update(k);i.removeClass("thumbnail-loading")});b(this).parent().parent().find("div").find("a").removeClass("thumbnail-active");b(this).addClass("thumbnail-active")})}})(jQuery);